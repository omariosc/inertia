<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: customer/CustomerCreateBooking.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: customer/CustomerCreateBooking.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* Purpose of file: Allow a customer to create a new booking */

import React, {useEffect, useState} from 'react';
import {useNavigate} from 'react-router-dom';
import {Button, Col, Container, Form, Row} from 'react-bootstrap';
import {NotificationManager} from 'react-notifications';
import {MapContainer, Marker, Popup, TileLayer} from 'react-leaflet';
import host from '../host';
import moment from 'moment';
import Cards from 'elt-react-credit-cards';
import 'elt-react-credit-cards/es/styles-compiled.css';
import {useAccount} from '../authorize';

/**
 * Renders the create booking page for the customer
 * @return {JSX.Element} Customer create booking page
 */
export default function CustomerCreateBooking() {
  const [account] = useAccount();
  const navigate = useNavigate();
  const [mapLocations, setMapLocations] = useState('');
  const [scooters, setScooters] = useState('');
  const [hireOptions, setHireOptions] = useState('');
  const [depotChoiceId, setDepotChoiceId] = useState('');
  const [scooterChoiceId, setScooterChoiceId] = useState('');
  const [hireChoiceId, setHireChoiceId] = useState('');
  const [startDate, setStartDate] = useState('');
  const [startTime, setStartTime] = useState('');
  const [price, setPrice] = useState('');
  const [cardNo, setCardNo] = useState('');
  const [expiry, setExpiry] = useState('');
  const [cvv, setCVV] = useState('');
  const [focus, setFocus] = useState('');
  const [validDepot, setValidDepot] = useState(true);
  const [validScooter, setValidScooter] = useState(true);
  const [validHireSlot, setValidHireSlot] = useState(true);
  const [validStartDate, setValidStartDate] = useState(true);
  const [validStartTime, setValidStartTime] = useState(true);
  const [validCardNo, setValidCardNo] = useState(true);
  const [validExpDate, setValidExpDate] = useState(true);
  const [validCVV, setValidCVV] = useState(true);
  const [discount, setDiscount] = useState(false);
  const [discountType, setDiscountType] = useState('');
  const [loading, setLoading] = useState('');
  const [saveCard, setSaveCard] = useState(false);
  const [savedCardDetails, setSavedCardDetails] = useState(null);

  useEffect(() => {
    fetchHirePeriods();
    fetchDiscountStatus();
    fetchLocations();
    checkCardExists();
  }, []);

  useEffect(() => {
    fetchAvailableScooters();
  }, [startTime, startDate, hireChoiceId, depotChoiceId]);

  /**
   * Gets a list of locations from the backend server
   */
  async function fetchLocations() {
    try {
      const request = await fetch(host + 'api/Depos', {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json',
        },
        mode: 'cors',
      });
      setMapLocations(await request.json());
    } catch (e) {
      console.log(e);
    }
  }

  /**
   * Checks if the customer is currently eligible for frequent user discount,
   * applies it and updates backend server if they are
   */
  async function getDiscountStatus() {
    try {
      const request = await fetch(host + `api/Users/${account.id}/orders`, {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json',
          'Authorization': `Bearer ${account.accessToken}`,
        },
        mode: 'cors',
      });
      const response = await request.json();
      const thresholdDate = moment().subtract(1, 'week').toISOString();
      const recentBookings = response.filter(
          (e) => e.createdAt >= thresholdDate);
      let recentHours = 0;
      for (let i = 0; i &lt; recentBookings.length; i++) {
        if (recentBookings[i].orderState !== 0 &amp;&amp;
            recentBookings[i].orderState !== 6) {
          recentHours += recentBookings[i].hireOption.durationInHours;
          if (recentBookings[i]['extensions'] != null) {
            for (let j = 0; j &lt; recentBookings[i]['extensions'].length; j++) {
              // eslint-disable-next-line max-len
              recentHours += recentBookings[i]['extensions'][j].hireOption.durationInHours;
            }
          }
        }
      }
      if (recentHours >= 8) {
        setDiscount(true);
        setDiscountType('Frequent User');
      }
    } catch (e) {
      console.log(e);
    }
  }

  /**
   * Checks if the user is eligible for another type of discount,
   * e.g. student discount and applies the discount
   */
  async function fetchDiscountStatus() {
    try {
      const request = await fetch(host + `api/Users/${account.id}/profile`, {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json',
          'Authorization': `Bearer ${account.accessToken}`,
        },
        mode: 'cors',
      });
      const response = await request.json();
      if (response.userType === 0) {
        setDiscount(true);
        setDiscountType('Student');
      } else if (response.userType === 1) {
        setDiscount(true);
        setDiscountType('Senior');
      } else if (response.userType === 3) {
        setDiscount(true);
        setDiscountType('Frequent User');
      } else {
        await getDiscountStatus();
      }
      setLoading('complete');
    } catch (e) {
      console.log(e);
    }
  }

  /**
   * Gets list of available hire lengths from backend server
   */
  async function fetchHirePeriods() {
    try {
      const request = await fetch(host + 'api/HireOptions', {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json',
          'Authorization': `Bearer ${account.accessToken}`,
        },
        mode: 'cors',
      });
      setHireOptions((await request.json()).sort((a, b) => a.cost - b.cost));
    } catch (error) {
      console.error(error);
    }
  }

  /**
   * Calculates the start time of the new booking
   * @return {string} booking start time in ISO format
   */
  function calcStartIso() {
    const hours = parseInt(startTime.slice(0, 2));
    const mins = parseInt(startTime.slice(3, 5));
    const bookingStart = new Date(startDate);
    bookingStart.setHours(hours, mins, 0, 0);
    return bookingStart.toISOString();
  }

  /**
   * Calculates the end time of the new booking
   * @return {string} booking end time in ISO format
   */
  function calcEndIso() {
    const hours = parseInt(startTime.slice(0, 2));
    const mins = parseInt(startTime.slice(3, 5));
    const bookingEnd = new Date(startDate);
    const duration = hireOptions.find(
        (x) => x.hireOptionId === parseInt(hireChoiceId)).durationInHours;
    bookingEnd.setHours(hours + duration, mins, 0, 0);
    return bookingEnd.toISOString();
  }

  /**
   * Gets list of available scooters for the new booking from the backend server
   */
  async function fetchAvailableScooters() {
    let valid = true;
    const validateFuncs = [
      validateTime,
      validateDate,
      validateDepot,
      validateHireSlot];
    validateFuncs.forEach((validateTerm) => {
      if (valid) {
        valid = validateTerm(false);
      } else {
        validateTerm(false);
      }
    });
    if (valid) {
      try {
        const requestString = host + 'api/Scooters/available/' + '?depoId=' +
            depotChoiceId + '&amp;startTime=' + calcStartIso() + '&amp;endTime=' +
            calcEndIso();
        const request = await fetch(requestString, {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json',
            'Authorization': `Bearer ${account.accessToken}`,
          },
          mode: 'cors',
        });
        setScooters((await request.json()).sort(
            (a, b) => a.softScooterId - b.softScooterId));
      } catch (error) {
        console.error(error);
      }
    } else {
      setScooters('');
      setScooterChoiceId('');
    }
  }

  /**
   * Checks date of the new booking is valid
   * @param {boolean} stateChange Dynamically updates UI if true
   * @return {boolean} True if valid, false otherwise
   */
  function validateDate(stateChange) {
    const currentDate = new Date();
    const dStartDate = new Date(startDate);
    currentDate.setHours(0, 0, 0, 0);
    dStartDate.setHours(0, 0, 0, 0);
    const valid = currentDate.toString() !== 'Invalid Date' &amp;&amp; currentDate &lt;=
        dStartDate;
    if (stateChange) {
      setValidStartDate(valid);
    }
    return valid;
  }

  /**
   * Checks time of the new booking is valid
   * @param {boolean} stateChange Dynamically updates UI if true
   * @return {boolean} True if valid, false otherwise
   */
  function validateTime(stateChange) {
    let valid;
    if (startTime.length !== 5) {
      valid = false;
    } else {
      const hours = parseInt(startTime.slice(0, 2));
      const mins = parseInt(startTime.slice(3, 5));
      if (hours &lt; 0 || hours > 23 || mins % 15 !== 0) {
        valid = false;
      } else {
        const currentDate = new Date();
        const dStartDate = new Date(startDate);
        currentDate.setSeconds(0, 0);
        dStartDate.setHours(hours, mins, 0, 0);
        valid = currentDate.toString() !== 'Invalid Date' &amp;&amp; currentDate &lt;=
            dStartDate;
      }
    }
    if (stateChange) {
      setValidStartTime(valid);
    }
    return valid;
  }

  /**
   * Checks depot of the new booking is valid
   * @param {boolean} stateChange Dynamically updates UI if true
   * @return {boolean} True if valid, false otherwise
   */
  function validateDepot(stateChange) {
    const valid = depotChoiceId !== '' &amp;&amp; depotChoiceId !== 'none';
    if (stateChange) {
      setValidDepot(valid);
    }
    return valid;
  }

  /**
   * Checks scooter for the new booking is valid
   * @param {boolean} stateChange Dynamically updates UI if true
   * @return {boolean} True if valid, false otherwise
   */
  function validateScooter(stateChange) {
    const valid = scooterChoiceId !== '' &amp;&amp; scooterChoiceId !== 'none';
    if (stateChange) {
      setValidScooter(valid);
    }
    return valid;
  }

  /**
   * Checks hire length of the new booking is valid
   * @param {boolean} stateChange Dynamically updates UI if true
   * @return {boolean} True if valid, false otherwise
   */
  function validateHireSlot(stateChange) {
    const valid = hireChoiceId !== '' &amp;&amp; hireChoiceId !== 'none';
    if (stateChange) {
      setValidHireSlot(valid);
    }
    return valid;
  }

  /**
   * Checks card number of the new booking is valid
   * @param {boolean} stateChange Dynamically updates UI if true
   * @return {boolean} True if valid, false otherwise
   */
  function validateCardNo(stateChange) {
    if (savedCardDetails !== null) {
      return true;
    }
    const valid = cardNo.length > 9 &amp;&amp; cardNo.length &lt; 20;
    if (stateChange) {
      setValidCardNo(valid);
    }
    return valid;
  }

  /**
   * Checks expiry date of the card for the new booking is valid
   * @param {boolean} stateChange Dynamically updates UI if true
   * @return {boolean} True if valid, false otherwise
   */
  function validateExpDate(stateChange) {
    if (savedCardDetails !== null) {
      return true;
    }
    const valid = expiry.match(/^(0[1-9]|1[0-2])\/?([0-9]{4}|[0-9]{2})$/);
    if (stateChange) {
      setValidExpDate(valid);
    }
    return valid;
  }

  /**
   * Checks CVV of the card for the new booking is valid
   * @param {boolean} stateChange Dynamically updates UI if true
   * @return {boolean} True if valid, false otherwise
   */
  function validateCVV(stateChange) {
    if (savedCardDetails !== null) {
      return true;
    }
    const valid = cvv.match(/^[0-9]{3,4}$/);
    if (stateChange) {
      setValidCVV(valid);
    }
    return valid;
  }

  /**
   * If all validations pass, creates a new booking with the specified
   * information and updates backend server
   */
  async function createBooking() {
    let valid = true;
    const validateFuncs = [
      validateTime,
      validateDate,
      validateDepot,
      validateScooter,
      validateHireSlot,
      validateCardNo,
      validateCVV,
      validateExpDate];
    validateFuncs.forEach((validateTerm) => {
      if (valid) {
        valid = validateTerm(true);
      } else {
        validateTerm(true);
      }
    });
    if (!valid) {
      NotificationManager.error('Invalid Details Provided', 'Error');
      return;
    }
    try {
      const request = await fetch(host + 'api/Orders', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json',
          'Authorization': `Bearer ${account.accessToken}`,
        },
        body: JSON.stringify({
          'hireOptionId': parseInt(hireChoiceId),
          'scooterId': parseInt(scooterChoiceId),
          'startTime': startDate + 'T' + startTime,
        }),
        mode: 'cors',
      });
      const response = await request;
      if (response.status === 422) {
        NotificationManager.error('Scooter is currently unavailable.', 'Error');
      } else if (response.status === 400) {
        NotificationManager.error('Please fill in all required fields.',
            'Error');
      } else if (response.status === 200) {
        NotificationManager.success('Created Booking.', 'Success');
        if (savedCardDetails === null &amp;&amp; saveCard) {
          const card = {
            cardNumber: cardNo,
            expiryDate: expiry,
            cvv: cvv,
          };
          (/^\d+$/.test(expiry)) ?
              card.expiry = expiry.slice(0, 3) + '/' + expiry.slice(3) :
              card.expiry = expiry;
          localStorage.setItem(account.id, JSON.stringify(card));
          NotificationManager.success('Stored credit card details.', 'Success');
        }
        navigate('/current-bookings');
      }
    } catch (error) {
      console.error(error);
    }
  }

  /**
   * Check if a card is stored in local cookies
   * @return {boolean} True if card exists, false otherwise
   */
  function checkCardExists() {
    if (localStorage.getItem(account.id)) {
      setSavedCardDetails(JSON.parse(localStorage.getItem(account.id)));
    }
    return (!!localStorage.getItem(account.id));
  }

  /**
   * Parses expiry date and converts it into the correct format
   * @param {Event} e On key press event
   */
  function parseExpiry(e) {
    if (e.keyCode === 8) {
      setExpiry(e.target.value);
      return;
    }
    setExpiry(e.target.value);
    e.target.value = e.target.value.replace(
        /^([1-9]\/|[2-9])$/g, '0$1/', // 3 > 03/
    ).replace(
        /^(0[1-9]|1[0-2])$/g, '$1/', // 11 > 11/
    ).replace(
        /^([0-1])([3-9])$/g, '0$1/$2', // 13 > 01/3
    ).replace(
        /^(0?[1-9]|1[0-2])([0-9]{2})$/g, '$1/$2', // 141 > 01/41
    ).replace(
        /^([0]+)\/|[0]+$/g, '0', // 0/ > 0 and 00 > 0
    ).replace(
        /[^\d\/]|^[\/]*$/g, '', // To allow only digits and `/`
    ).replace(
        /\/\//g, '/', // Prevent entering more than 1 `/`
    );
    setExpiry(e.target.value);
  }

  /**
   * Shows total cost of the new booking
   * @return {JSX.Element} the cost element
   */
  function DisplayCost() {
    return (
        (isNaN(parseFloat(price))) ? null :
            (loading === '') ? null :
                (discount) ?
                    &lt;Row className="pb-2">
                      &lt;Col>
                        {(hireChoiceId === '') ? null :
                            &lt;>
                              &lt;h5>Cost: £{(0.9 * parseFloat(price)).toFixed(
                                  2)}&lt;/h5>
                              &lt;Row className="pb-2">
                                &lt;Col
                                  className="text-end col-3 align-self-center">
                                  Discount:
                                &lt;/Col>
                                &lt;Col>
                                  {discountType} (10%) applied
                                &lt;/Col>
                              &lt;/Row>
                            &lt;/>
                        }
                      &lt;/Col>
                    &lt;/Row> :
                    &lt;Row className="pb-2">
                      &lt;Col>Cost £{(hireChoiceId === '') ? null :
                          `${parseFloat(price).toFixed(2)}`
                      }
                      &lt;/Col>
                    &lt;/Row>
    );
  }

  return (
    &lt;Container>
      &lt;Row className="mapMaxHeightRow">
        {(mapLocations === '') ? &lt;Col>Loading map locations...&lt;/Col> :
              &lt;Col className="box col=12">
                &lt;MapContainer center={[
                  mapLocations[0].latitude,
                  mapLocations[0].longitude]} zoom={15}
                zoomControl={false} className="minimap-box">
                  &lt;TileLayer
                    attribution='&amp;copy; &lt;a href="http://osm.org/copyright">OpenStreetMap&lt;/a> contributors'
                    url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"/>
                  {mapLocations.map((location, index) => (
                    &lt;Marker key={index}
                      position={[
                        location.latitude,
                        location.longitude]}
                      eventHandlers={{
                        click: () => {
                          setScooterChoiceId('');
                          setDepotChoiceId(location.depoId);
                        },
                      }}>
                      &lt;Popup>
                        &lt;Button className="disabled">
                          {location.name}
                        &lt;/Button>
                      &lt;/Popup>
                    &lt;/Marker>
                  ))}
                &lt;/MapContainer>
              &lt;/Col>
        }
      &lt;/Row>
      &lt;br className="box"/>
      &lt;h5>Booking Details&lt;/h5>
      &lt;Row className="pb-2">
        &lt;Col className="text-end col-3 align-self-center">
            Depot:
        &lt;/Col>
        &lt;Col>
          {(mapLocations === '') ? &lt;> Loading depots... &lt;/> :
                &lt;Form.Select value={depotChoiceId} isInvalid={!validDepot}
                  onChange={(e) => {
                    setDepotChoiceId(e.target.value);
                    setScooterChoiceId('');
                  }}>
                  &lt;option value="" key="none" disabled hidden>Select Depot
                  &lt;/option>
                  {mapLocations.map((depot, idx) => (
                    &lt;option value={depot.depoId}
                      key={idx}>{depot.name}&lt;/option>
                  ))}
                &lt;/Form.Select>
          }
        &lt;/Col>
      &lt;/Row>
      &lt;Row className="pb-2">
        &lt;Col className="text-end col-3 align-self-center">
            Start Time:
        &lt;/Col>
        &lt;Col>
          &lt;Container className="p-0">
            &lt;Row>
              &lt;Col>
                &lt;Form.Control type="date" isInvalid={!validStartDate}
                  onChange={(e) => {
                    setStartDate(e.target.value);
                  }}/>
              &lt;/Col>
              &lt;Col>
                &lt;Form.Control type="time"
                  isInvalid={!validStartTime}
                  value={startTime}
                  onChange={(e) => {
                    let output = e.target.value.slice(0, 3);
                    let minutes = parseInt(
                        e.target.value.slice(3, 5));
                    if (minutes % 15 === 1) {
                      minutes = (minutes + 14) % 60;
                    } else if (minutes % 15 === 14) {
                      minutes = (minutes - 14);
                    } else if (minutes % 15 !== 0) {
                      minutes = (Math.round(minutes / 15) % 4) *
                                        15;
                    }
                    const minString = minutes.toString();
                    if (minString.length === 1) {
                      output += '0' + minString;
                    } else {
                      output += minString;
                    }
                    setStartTime(output);
                  }
                  }/>
              &lt;/Col>
            &lt;/Row>
          &lt;/Container>
        &lt;/Col>
      &lt;/Row>
      &lt;Row className="pb-2">
        &lt;Col className="text-end col-3 align-self-center">
            Hire Period:
        &lt;/Col>
        &lt;Col>
          {(hireOptions === '') ? &lt;>Loading hire periods...&lt;/> : &lt;>
            &lt;Form.Select isInvalid={!validHireSlot} defaultValue="none"
              onChange={(e) => {
                const value = e.target.value.split(',');
                setHireChoiceId(value[0]);
                setPrice(value[1]);
              }}>

              &lt;option value="none" key="none" disabled hidden>Select Hire
                  Period
              &lt;/option>
              {hireOptions.map((option, idx) => (
                &lt;option key={idx} value={[
                  option.hireOptionId,
                  option.cost]}>{option.name} -
                      £{option.cost}&lt;/option>
              ))}
            &lt;/Form.Select>
          &lt;/>
          }
        &lt;/Col>
      &lt;/Row>
      &lt;Row className="pb-2">
        &lt;Col className="text-end col-3 align-self-center">
            Scooter:
        &lt;/Col>
        &lt;Col>

          &lt;Form.Select
            value={scooterChoiceId}
            isInvalid={!validScooter}
            disabled={scooters === ''}
            onChange={(e) => {
              setScooterChoiceId(e.target.value);
            }}>
            {scooters === '' ?
                  &lt;option value="" key="none" disabled hidden>Please fill in
                    other details&lt;/option> : &lt;>
                    &lt;option value="" key="none" disabled hidden>Select Scooter
                    &lt;/option>
                    {scooters.map((scooter, idx) => (
                      &lt;option value={scooter.scooterId}
                        key={idx}>{scooter.softScooterId}&lt;/option>
                    ))}
                  &lt;/>
            }
          &lt;/Form.Select>

        &lt;/Col>
      &lt;/Row>
      &lt;br/>
      &lt;DisplayCost/>
      &lt;div className="issue-filters">
        {savedCardDetails === null ?
              &lt;>
                &lt;h5>Payment details&lt;/h5>
                &lt;Row className="pb-2 small-padding-top">
                  &lt;Col className="text-end col-3 align-self-center">
                    Save Card Details:
                  &lt;/Col>
                  &lt;Col>
                    &lt;Form.Switch onClick={(e) =>
                      setSaveCard(e.target.checked)}/>
                  &lt;/Col>
                &lt;/Row>
                &lt;Row className="pb-2 small-padding-top">
                  &lt;Cards
                    cvc={cvv}
                    expiry={expiry}
                    focused={focus}
                    name={account.name}
                    number={cardNo}
                  />
                &lt;/Row>
                &lt;Row className="pb-2 small-padding-top">
                  &lt;Col className="text-end col-3 align-self-center">
                    Card Number:
                  &lt;/Col>
                  &lt;Col className="text-end">
                    &lt;Form.Control type="text" name="number"
                      placeholder="4000-1234-5678-9010"
                      maxlength="16"
                      isInvalid={!validCardNo}
                      onChange={(e) =>
                        setCardNo(
                            e.target.value.replace(/^\d$/, ''))}
                      onFocus={(e) => setFocus(e.target.name)}/>
                    &lt;Form.Control.Feedback type="invalid">
                      Invalid Card Number
                    &lt;/Form.Control.Feedback>
                  &lt;/Col>
                &lt;/Row>
                &lt;Row className="pb-2">
                  &lt;Col className="text-end col-3 align-self-center">
                    Expiry Date:
                  &lt;/Col>
                  &lt;Col className="text-end">
                    &lt;Form.Control type="text" name="expiry" placeholder="MM/YY"
                      maxlength="5"
                      isInvalid={!validExpDate}
                      onKeyDown={(e) => {
                        parseExpiry(e);
                      }}
                      onChange={(e) => setExpiry(e.target.value)}
                      onFocus={(e) => setFocus(e.target.name)}/>
                    &lt;Form.Control.Feedback type="invalid">
                      Invalid Expiry Date
                    &lt;/Form.Control.Feedback>
                  &lt;/Col>
                &lt;/Row>
                &lt;Row className="pb-2">
                  &lt;Col className="text-end col-3 align-self-center">
                    CVV:
                  &lt;/Col>
                  &lt;Col className="text-end">
                    &lt;Form.Control type="text" name="cvc" placeholder="123"
                      maxlength="3"
                      isInvalid={!validCVV}
                      onChange={(e) => setCVV(e.target.value)}
                      onFocus={(e) => setFocus(e.target.name)}/>
                    &lt;Form.Control.Feedback type="invalid">
                      Invalid CVV
                    &lt;/Form.Control.Feedback>
                  &lt;/Col>
                &lt;/Row>
              &lt;/> :
              &lt;>
                &lt;h5>Using stored payment details&lt;/h5>
                &lt;Row className="pb-2">
                  &lt;Col className="text-end col-3 align-self-center">
                    Card Number:
                  &lt;/Col>
                  &lt;Col>
                    **** ****
                    **** {savedCardDetails.cardNumber.slice(
                        savedCardDetails.cardNumber.length - 4)}
                  &lt;/Col>
                &lt;/Row>
                &lt;Row className="pb-2">
                  &lt;Col className="text-end col-3 align-self-center">
                    Expiry Date:
                  &lt;/Col>
                  &lt;Col>
                    {savedCardDetails.expiryDate}
                  &lt;/Col>
                &lt;/Row>
                &lt;Row>
                  &lt;Col className="offset-3">
                    &lt;Button
                      variant="danger"
                      onClick={() => {
                        localStorage.removeItem(account.id);
                        NotificationManager.success(
                            'Deleted credit card details.', 'Success');
                        setSavedCardDetails(null);
                      }}>
                      Delete Card Details
                    &lt;/Button>
                  &lt;/Col>
                &lt;/Row>
              &lt;/>
        }
      &lt;/div>
      &lt;div className="issue-filters-mobile">
        {savedCardDetails === null ?
              &lt;>
                &lt;h5>Payment details&lt;/h5>
                &lt;Row className="small-padding-bottom">
                  Save Card Details:
                  &lt;Col>
                    &lt;Form.Switch
                      onClick={(e) => setSaveCard(
                          e.target.checked)}/>
                  &lt;/Col>
                &lt;/Row>
                &lt;Row
                  className="small-padding-bottom customer-create-booking-card">
                  &lt;Cards
                    cvc={cvv}
                    expiry={expiry}
                    focused={focus}
                    name={account.name}
                    number={cardNo}
                  />
                &lt;/Row>
                &lt;Row className="small-padding-bottom">
                  Card Number:
                  &lt;Form.Control type="text" name="number"
                    placeholder="4000-1234-5678-9010"
                    maxlength="16"
                    isInvalid={!validCardNo}
                    onChange={(e) =>
                      setCardNo(
                          e.target.value.replace(/^\d$/, ''))}
                    onFocus={(e) => setFocus(
                        e.target.name)}/>
                  &lt;Form.Control.Feedback type="invalid">
                    Invalid Card Number
                  &lt;/Form.Control.Feedback>
                &lt;/Row>
                &lt;Row className="small-padding-bottom">
                  Expiry Date:
                  &lt;Form.Control type="text" name="expiry"
                    placeholder="MM/YY"
                    maxlength="5"
                    isInvalid={!validExpDate}
                    onChange={(e) => setExpiry(
                        e.target.value)}
                    onKeyDown={(e) => {
                      parseExpiry(e);
                    }}
                    onFocus={(e) => setFocus(
                        e.target.name)}/>
                  &lt;Form.Control.Feedback type="invalid">
                    Invalid Expiry Date
                  &lt;/Form.Control.Feedback>
                &lt;/Row>
                &lt;Row>
                  CVV:
                  &lt;Form.Control type="text" name="cvc"
                    placeholder="123"
                    maxlength="3"
                    isInvalid={!validCVV}
                    onChange={(e) => setCVV(
                        e.target.value)}
                    onFocus={(e) => setFocus(
                        e.target.name)}/>
                  &lt;Form.Control.Feedback type="invalid">
                    Invalid CVV
                  &lt;/Form.Control.Feedback>
                &lt;/Row>
              &lt;/> :
              &lt;>
                &lt;h5>Using stored payment details&lt;/h5>
                &lt;p>Card Number: **** ****
                  **** {savedCardDetails.cardNumber.slice(
                    savedCardDetails.cardNumber.length - 4)} &lt;/p>
                &lt;p>Expiry Date: {savedCardDetails.expiryDate} &lt;/p>
                &lt;Button
                  variant="danger"
                  className="float-right"
                  onClick={() => {
                    localStorage.removeItem(account.id);
                    NotificationManager.success(
                        'Deleted credit card details.', 'Success');
                    setSavedCardDetails(null);
                  }}>
                  Delete Card Details
                &lt;/Button>
                &lt;br/>
                &lt;br/>
              &lt;/>
        }
      &lt;/div>
      &lt;br/>
      &lt;div className="text-center">
        &lt;Button onClick={createBooking}>Confirm Booking&lt;/Button>
      &lt;/div>
      &lt;br/>
      &lt;div className="issue-filters-mobile">
      &lt;/div>
    &lt;/Container>
  );
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Account.html">Account</a></li></ul><h3>Global</h3><ul><li><a href="global.html#accountFromCookies">accountFromCookies</a></li><li><a href="global.html#AccountProvider">AccountProvider</a></li><li><a href="global.html#signIn">signIn</a></li><li><a href="global.html#signOut">signOut</a></li><li><a href="global.html#useAccount">useAccount</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Sun May 01 2022 22:09:55 GMT+0100 (British Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
